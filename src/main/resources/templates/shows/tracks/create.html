<!DOCTYPE html>
<html lang="en" , xmlns:th="https://www.thymeleaf.org">
<head th:insert="fragments/layout :: head">
</head>
<body>
<div th:insert="fragments/layout :: navbar"></div>
<div class="container">
    <form
            action="#"
            th:action="@{/shows/{id}/tracks (id=${showId})}"
            th:object="${tracklist}"
            method="post"
    >
        <fieldset>
        <table>
            <thead>
                <th>Artist</th>
                <th>Title</th>
                <th>URL</th>
                <th></th>
            </thead>
            <tbody id="tracklist" data-test="tracklist">
                <tr id="inputs">
                    <td>
                        <input type="text" id="artist-input" data-test="artist-input" autofocus/>
                    </td>
                    <td>
                        <input type="text" id="title-input" data-test="title-input"/>
                    </td>
                    <td>
                        <input type="text" id="url-input" data-test="url-input"/>
                    </td>
                    <td>
                        <button type="button" id="add-track" data-test="add-track">Add</button>
                    </td>
                </tr>
            </tbody>
        </table>
        </fieldset>
        <br>
        <br>
        <br>
        <input type="submit" data-test="submit" value="Add to tracklist">
    </form>

    <script>
        $('#add-track').click(function() {
            let artist = $('#artist-input').val();
            let title = $('#title-input').val();
            let url = $('#url-input').val();

            $('#artist-input').val('');
            $('#title-input').val('');
            $('#url-input').val('');

            let rowNumber = $('#tracklist tr').length - 1;
            let artistCell = '<td><input name="tracks[' + rowNumber + '].artist" type="text" value="' + artist + '" data-test="artist" readonly/></td>'
            let titleCell = '<td><input name="tracks[' + rowNumber + '].title" type="text" value="' + title + '" data-test="title" readonly/></td>'
            let urlCell = '<td><input name="tracks[' + rowNumber + '].url" type="text" value="' + url + '" data-test="url" readonly/></td>'

            let row = '<tr data-test="tracks">' + artistCell + titleCell + urlCell + '</tr>';
            $(row).insertBefore('#inputs');
        });
    </script>
</div>
</body>
</html>